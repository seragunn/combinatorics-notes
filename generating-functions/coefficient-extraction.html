<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Combinatorics Notes - 13&nbsp; Coefficient Extraction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../generating-functions/generating-function-exercises.html" rel="next">
<link href="../generating-functions/stars-and-bars-revisited.html" rel="prev">
<link href="../icon.svg" rel="icon" type="image/svg+xml">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../style.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Combinatorics Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://trevorgunn.github.io/"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.appliedcombinatorics.org/book/app-comb.html"> 
<span class="menu-text">Applied Combinatorics</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/trevorgunn/combinatorics-notes/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="../Combinatorics-Notes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../generating-functions/weights.html">Generating Functions</a></li><li class="breadcrumb-item"><a href="../generating-functions/coefficient-extraction.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Coefficient Extraction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Inclusion-Exclusion</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inclusion-exclusion/inclusion-exclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Inclusion/Exclusion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../inclusion-exclusion/totient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Euler’s Totient Function</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Permutations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permutations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Permutations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/visual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Visual representations of permutations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/generators.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generators</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/sign.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Sign of a Permutation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/inversions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Inversions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../permutations/permutation-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Generating Functions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generating-functions/weights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Weight Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generating-functions/ogf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Generating Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generating-functions/multiplication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Multiplication of Generating Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generating-functions/stars-and-bars-revisited.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Stars and Bars Revisited</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generating-functions/coefficient-extraction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Coefficient Extraction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../generating-functions/generating-function-exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Exercises</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Regular Languages</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regular-languages/regular-languages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regular Languages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../regular-languages/finite-automata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Finite Automata</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#shifts" id="toc-shifts" class="nav-link active" data-scroll-target="#shifts"><span class="header-section-number">13.1</span> Shifts</a></li>
  <li><a href="#sums-and-differences" id="toc-sums-and-differences" class="nav-link" data-scroll-target="#sums-and-differences"><span class="header-section-number">13.2</span> Sums and differences</a></li>
  <li><a href="#derivatives" id="toc-derivatives" class="nav-link" data-scroll-target="#derivatives"><span class="header-section-number">13.3</span> Derivatives</a></li>
  <li><a href="#newtons-binomial-theorem" id="toc-newtons-binomial-theorem" class="nav-link" data-scroll-target="#newtons-binomial-theorem"><span class="header-section-number">13.4</span> Newton’s Binomial Theorem</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples"><span class="header-section-number">13.5</span> Examples</a>
  <ul class="collapse">
  <li><a href="#negative-binomial-theorem" id="toc-negative-binomial-theorem" class="nav-link" data-scroll-target="#negative-binomial-theorem"><span class="header-section-number">13.5.1</span> Negative Binomial Theorem</a></li>
  <li><a href="#central-binomial-theorem" id="toc-central-binomial-theorem" class="nav-link" data-scroll-target="#central-binomial-theorem"><span class="header-section-number">13.5.2</span> Central Binomial Theorem</a></li>
  <li><a href="#catalan-numbers" id="toc-catalan-numbers" class="nav-link" data-scroll-target="#catalan-numbers"><span class="header-section-number">13.5.3</span> Catalan Numbers</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/trevorgunn/combinatorics-notes/edit/main/generating-functions/coefficient-extraction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/trevorgunn/combinatorics-notes/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/trevorgunn/combinatorics-notes/blob/main/generating-functions/coefficient-extraction.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../generating-functions/weights.html">Generating Functions</a></li><li class="breadcrumb-item"><a href="../generating-functions/coefficient-extraction.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Coefficient Extraction</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Coefficient Extraction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this section, we develop some techniques for extracting coefficients from generating functions. Remember that coefficient of <span class="math inline">\(x^n\)</span> represents the number of solutions of weight <span class="math inline">\(n\)</span>. So knowing that the generating function is, for example,</p>
<p><span class="math display">\[
A(x) = \frac{x^{k - 1}(x^5 - x^{14})}{(1 - x)^k} = \sum a_n x^n,
\]</span></p>
<p>our goal is to find <span class="math inline">\(a_n\)</span>. A common notation for this is <span class="math inline">\(a_n = [x^n] A(x)\)</span>.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Be careful! This is not the same thing as <span class="math inline">\(A(n)\)</span>. Plugging in <span class="math inline">\(n\)</span> is not the way to find the coefficient. For example, the coefficient of <span class="math inline">\(x^2\)</span> in the quadratic <span class="math inline">\(f(x) = 2x^2 + 3x + 1\)</span> is <span class="math inline">\([x^2]f(x) = 2\)</span> and not <span class="math inline">\(f(2)\)</span> which equals <span class="math inline">\(15\)</span>.</p>
</div>
</div>
<section id="shifts" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="shifts"><span class="header-section-number">13.1</span> Shifts</h2>
<p>Multiplying <span class="math inline">\(A(x)\)</span> by <span class="math inline">\(x^k\)</span> shifts the sequence left or right (depending on whether <span class="math inline">\(k\)</span> is positive or negative): <span class="math display">\[
x^k \sum a_n x^n = \sum a_n x^{n + k} = \sum a_{n - k} x^n.
\]</span> The second equals sign is obtained either by substituting <span class="math inline">\(n \gets n + k\)</span> or by noticing that the coefficient is always <span class="math inline">\(k\)</span> less than the exponent.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Substituting inside a sum
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Consider a summation like <span class="math display">\[
\sum_{k = 2}^\infty k(k-1)x^{k - 2}.
\]</span> If we want to write this as a sum where <span class="math inline">\(x^k\)</span> is the exponent in our summand, then we can either</p>
<ol type="1">
<li>add <span class="math inline">\(2\)</span> everywhere we see <span class="math inline">\(k\)</span>: <span class="math display">\[
\sum_{k + 2 = 2}^\infty (k + 2)(k + 1)x^{k} = \sum_{k = 0}^\infty (k + 2)(k + 1)x^{k},
\]</span></li>
<li>make a substitution of <span class="math inline">\(n = k - 2\)</span> and <span class="math inline">\(k = n + 2\)</span> to get <span class="math display">\[
\sum_{n + 2 = 2}^\infty (n + 2)(n + 1)x^{n}.
\]</span></li>
</ol>
<p>Both methods are equivalent.</p>
</div>
</div>
</div>
<p>Putting this together, we have the following result.</p>
<div id="thm-shift-coefficient" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.1 (Coefficient Shift)</strong></span> If <span class="math inline">\(A(x) = \sum a_nx^n\)</span> then <span class="math display">\[
[x^n]x^kA(x) = [x^{n - k}] A(x) = a_{n - k}.
\]</span> “The coefficient of <span class="math inline">\(x^n\)</span> in <span class="math inline">\(x^k A(x)\)</span> is <span class="math inline">\(a_{n - k}\)</span>.”</p>
</div>
</section>
<section id="sums-and-differences" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sums-and-differences"><span class="header-section-number">13.2</span> Sums and differences</h2>
<p>Suppose <span class="math inline">\(A(x) = \sum a_n x^n, B(x) = \sum b_n x^n\)</span> are two power series. Then for any constants <span class="math inline">\(\lambda, \mu\)</span>, we have <span class="math display">\[
\lambda A(x) + \mu B(x) = \lambda \sum a_n x^n + \mu \sum b_n x^n = \sum (\lambda a_n + \mu b_n) x^n.
\]</span> In terms of our <span class="math inline">\([x^n]\)</span> operator, we record the following result.</p>
<div id="thm-linear-coefficient" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.2 (Linear Combinations)</strong></span> <span class="math display">\[
[x^n](\lambda A(x) + \mu B(x)) = \lambda [x^n] A(x) + \mu [x^n] B(x).
\]</span></p>
</div>
</section>
<section id="derivatives" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="derivatives"><span class="header-section-number">13.3</span> Derivatives</h2>
<p>As we saw earlier, <span class="math display">\[
A'(x) = \sum na_nx^{n - 1} = \sum (n + 1)a_{n + 1}x^n.
\]</span></p>
<div id="thm-derivative-coefficient" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.3 (Derivatives and Antiderivatives)</strong></span> <span class="math display">\[
[x^n] A'(x) = (n + 1) [x^{n + 1}] A(x).
\]</span> Or for antiderivatives, <span class="math display">\[
[x^n] A(x) = \frac{1}{n} [x^{n - 1}] A'(x).
\]</span></p>
</div>
</section>
<section id="newtons-binomial-theorem" class="level2" data-number="13.4">
<h2 data-number="13.4" class="anchored" data-anchor-id="newtons-binomial-theorem"><span class="header-section-number">13.4</span> Newton’s Binomial Theorem</h2>
<p>We’ve seen the Binomial Theorem, <span class="math display">\[
(1 + x)^n = \sum_{k = 0}^n \binom{n}{k}x^k.
\]</span> And, in the previous section, we worked out power series for <span class="math inline">\((1 - x)^{-n}\)</span>. These kinds of functions are quite common in combinatorics, and not just for integer exponents either.</p>
<div id="def-general-binom" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 13.1</strong></span> The general binomial coefficient is <span class="math display">\[
\binom{r}{k} = \frac{r(r - 1)(r - 2) \cdots (r - k + 1)}{k!}
\]</span> and we define this for any real (or complex) number <span class="math inline">\(r\)</span>.</p>
</div>
<p>What Newton observed, is that when you take the derivative of <span class="math inline">\(f(x) = (1 + x)^r\)</span> a few times, you get <span class="math display">\[
r(1+x)^{r - 1} \text{ then } r(r - 1) (1 + x)^{r - 2} \text{ then } r(r - 1)(r - 2)(1 + x)^{r - 3}, \dots
\]</span></p>
<div id="thm-newton-binom" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.4 (Newton’s Binomial Theorem)</strong></span> The Taylor series of <span class="math inline">\((1 + x)^r\)</span> is <span class="math display">\[
\sum_{k = 0}^\infty \binom{r}{k}x^k.
\]</span></p>
</div>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>We’ve seen above that for <span class="math inline">\(f(x) = (1 + x)^r\)</span>, we have <span class="math display">\[
f^{(k)}(x) = r(r-1)(r-2)\cdots(r - k + 1)(1 + x)^{r - k}.
\]</span> Plugging this into the formula for a Taylor series, <span class="math display">\[
(1 + x)^r = \sum_{k = 0}^\infty \frac{f^{(k)}(0)}{k!} x^k = \sum_{k = 0}^\infty \frac{r(r - 1)(r - 2) \cdots (r - k + 1)}{k!} = \sum_{k = 0}^\infty \binom{r}{k}x^k.
\]</span></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>These series converge for at least <span class="math inline">\(|x| &lt; 1\)</span> (and so techniques of calculus apply to analyzing these series). Convergence for <span class="math inline">\(x = \pm 1\)</span> depends on <span class="math inline">\(r\)</span>. And of course, if <span class="math inline">\(r\)</span> is a whole number then the series is finite and converges everywhere.</p>
</div>
</div>
</section>
<section id="examples" class="level2" data-number="13.5">
<h2 data-number="13.5" class="anchored" data-anchor-id="examples"><span class="header-section-number">13.5</span> Examples</h2>
<p>Let’s finally get to solving the problem of <a href="stars-and-bars-revisited.html#sec-upper-bound-ogf" class="quarto-xref"><span>Section 12.2.1</span></a>. Recall that we had the generating function <span class="math display">\[
A(x) = \frac{x^{k - 1}(x^5 - x^{14})}{(1 - x)^k} = \frac{x^{k + 4} - x^{k + 13}}{(1 - x)^k}.
\]</span> Now we’re going to combine this with the first formula from <a href="stars-and-bars-revisited.html#sec-sb-ogf-summary" class="quarto-xref"><span>Section 12.4</span></a> to get <span class="math display">\[\begin{align*}
[x^n] \frac{x^{k + 4} - x^{k + 13}}{(1 - x)^k} &amp;= [x^n] x^{k + 4} \frac{1}{(1 - x^k)} - [x^n] x^{k + 13} \frac{1}{(1 - x)^k} \\
&amp;= [x^{n - k - 4}] \frac{1}{(1 - x)^k} - [x^{n - k - 13}] \frac{1}{(1 - x)^k} \\
&amp;= \binom{(n - k - 4) + k - 1}{k - 1} - \binom{(n - k - 13) + k - 1}{k - 1} \\
&amp;= \binom{n - 5}{k - 1} - \binom{n - 14}{k - 1}.
\end{align*}\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Coefficient extraction with the formulas
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The formula from <a href="stars-and-bars-revisited.html#sec-sb-ogf-summary" class="quarto-xref"><span>Section 12.4</span></a> says <span class="math display">\[
\frac{1}{(1 - x)^k} = \sum_{n = 0}^\infty \binom{n + k - 1}{k - 1}x^n.
\]</span> That means that the coefficient of <span class="math inline">\(x^n\)</span> is <span class="math display">\[
[x^n] \frac{1}{(1 - x)^k} = \binom{n + k - 1}{k - 1}.
\]</span> If we want to apply this to a more complex power of <span class="math inline">\(x\)</span>, we do so by substituting where we see <span class="math inline">\(n\)</span>, for example, <span class="math display">\[
[x^{n + 1}] \frac{1}{(1 - x)^k} = \binom{(n + 1) + k - 1}{k - 1} = \binom{n + k}{k - 1}.
\]</span></p>
</div>
</div>
</div>
<section id="negative-binomial-theorem" class="level3" data-number="13.5.1">
<h3 data-number="13.5.1" class="anchored" data-anchor-id="negative-binomial-theorem"><span class="header-section-number">13.5.1</span> Negative Binomial Theorem</h3>
<p>Comparing <a href="#thm-newton-binom" class="quarto-xref">Theorem&nbsp;<span>13.4</span></a> and formula (a.) of <a href="stars-and-bars-revisited.html#sec-sb-ogf-summary" class="quarto-xref"><span>Section 12.4</span></a> yields an interesting result:</p>
<p><span id="eq-negative-binomial"><span class="math display">\[
\frac{1}{(1 - x)^k} = \sum_{n = 0}^\infty \binom{n + k - 1}{k - 1} x^n = \sum_{n = 0}^\infty \binom{-k}{n} (-x)^n.
\tag{13.1}\]</span></span> Note that we are looking at <span class="math inline">\((1 - x)^{-k}\)</span> not <span class="math inline">\((1 + x)^{-k}\)</span> hence the <span class="math inline">\((-x)\)</span> on the right.</p>
<p>The next theorem is most often stated with <span class="math inline">\(n\)</span> and <span class="math inline">\(k\)</span> swapped. We also use the identity <span class="math inline">\(\binom{a + b}{a} = \binom{a + b}{b}\)</span>.</p>
<div id="thm-negative-binomial" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.5 (Negative Binomial Theorem)</strong></span> <span class="math display">\[
\binom{-k}{n} (-1)^n = \binom{n + k - 1}{k - 1} = \binom{n + k - 1}{n}.
\]</span> Or, with <span class="math inline">\(n\)</span> and <span class="math inline">\(k\)</span> in the usual position: <span class="math display">\[
\binom{-n}{k} (-1)^k = \binom{n + k - 1}{n - 1} = \binom{n + k - 1}{k}.
\]</span></p>
</div>
<p>Like many things in combinatorics, it’s interesting to give a second proof of this beyond the generating function proof in <a href="#eq-negative-binomial" class="quarto-xref">Equation&nbsp;<span>13.1</span></a>.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[\begin{align*}
\binom{-n}{k} (-1)^k &amp;= \frac{(-n)(-n - 1)(-n - 2)\cdots(-n-k+1)}{k!} (-1)^k \\
&amp;= \frac{(n)(n + 1)(n + 2)\cdots(n+k-1)}{k!} \\
&amp;= \frac{(n + k - 1)(n + k - 2) \cdots (n + 1)(n)}{k!} \\
&amp;= \binom{n + k - 1}{k}.
\end{align*}\]</span> In line 2, we distribute one <span class="math inline">\(-1\)</span> to each of the <span class="math inline">\(k\)</span> factors in the numerator.</p>
</div>
</section>
<section id="central-binomial-theorem" class="level3" data-number="13.5.2">
<h3 data-number="13.5.2" class="anchored" data-anchor-id="central-binomial-theorem"><span class="header-section-number">13.5.2</span> Central Binomial Theorem</h3>
<p>We’ve seen the binomial theorem with a whole number exponent. We’ve seen it with a negative integer exponent. The next place to go is fractions. Let’s start with <span class="math inline">\(n = \frac12\)</span>. For reference, here are the first couple values of this:</p>
<div id="00cc029f" class="cell" data-execution_count="1">
<pre class="sage cell-code"><code>for k in range(4):
    print(binomial(1/2, k))</code></pre>
<div class="cell-output cell-output-stdout">
<pre><code>1
1/2
-1/8
1/16</code></pre>
</div>
</div>
<p>It would seem that these are <span class="math inline">\(\pm 1\)</span> over some power of <span class="math inline">\(2\)</span> but if we continue our computation, we find that the next value is <span class="math inline">\(-5/128\)</span>.</p>
<p>In order to get to the bottom of this, we need to work this out from the definition:</p>
<p><span class="math display">\[\begin{align*}
\binom{1/2}{k} &amp;= \frac{\frac12(\frac12 - 1)(\frac12 - 2)\cdots(\frac12 - k + 1)}{k!} \\
&amp;= \frac{\frac12 (-\frac12)(-\frac32)(-\frac52) \cdots (-\frac{2k - 3}{2})}{k!} \\
&amp;= \frac{(-\frac12)^{k-1}(1)(3)(5)\cdots(2k-3)}{2k!} \\
&amp;= (-1)^{k-1}\frac{(1)(3)(5)\cdots(2k-3)}{2^kk!}. \\
\end{align*}\]</span></p>
<p>This is a pretty good formula. We can also write it in terms of the <a href="https://en.wikipedia.org/wiki/Double_factorial">double factorial</a> which is the product of all the odd numbers up to <span class="math inline">\(2k - 3\)</span>. (It’s called <em>double</em> because the factors decrease by <span class="math inline">\(2\)</span> each time instead of <span class="math inline">\(1\)</span>.)</p>
<p>But like in the Wikipedia article, we can write double factorials in terms of more usual factorials. We do this by adding in the missing even numbers to the numerator and balancing that out in the denominator:</p>
<p><span class="math display">\[\begin{align*}
\binom{1/2}{k} &amp;= (-1)^{k-1}\frac{(1)(3)\cdots(2k-3) \cdot (2)(4) \cdots (2k - 2)}{2^kk! \cdot (2)(4) \cdots (2k - 2)} \\
&amp;= (-1)^{k-1}\frac{(1)(2)(3)\cdots(2k-3)(2k - 2)}{2^kk! \cdot 2^{k-1} (1)(2) \cdots (k - 1)} \\
&amp;= (-1)^{k-1}\frac{(2k - 2)!}{2^{2k-1}k!(k - 1)!} \\
&amp;= (-1)^{k-1} \frac{1}{2^{2k - 1}k} \binom{2k-2}{k - 1}
\end{align*}\]</span></p>
<p>Let’s do this once more with <span class="math inline">\(n = -1/2\)</span> but going through the steps a bit quicker:</p>
<p><span class="math display">\[\begin{align*}
\binom{-1/2}{k} &amp;= \frac{(-\frac12)(-\frac32)(-\frac52) \cdots (-\frac{2k - 1}{2})}{k!} \\
&amp;= (-1)^k \frac{1 \cdot 3 \cdot 5 \cdots (2k - 1)}{2^k k!} \\
&amp;= (-1)^k \frac{(2k)!}{2^k k! \cdot (2)(4) \cdots (2k)} \\
&amp;= (-1)^k \frac{(2k)!}{2^k k! \cdot 2^k k!} \\
&amp;= (-1)^k \frac{1}{4^k} \binom{2k}{k}.
\end{align*}\]</span></p>
<p>Let us record these results as a theorem.</p>
<div id="thm-half-binom" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.6 (Half Binomials)</strong></span> <span class="math display">\[
\binom{1/2}{k} = (-1)^{k-1} \frac{1}{2^{2k - 1}k} \binom{2k-2}{k - 1} \text{ and } \binom{-1/2}{k} = \frac{(-1)^k}{4^k} \binom{2k}{k}.
\]</span> The first formula is only valid for <span class="math inline">\(k \ge 1\)</span>. If <span class="math inline">\(k = 0\)</span> then we get <span class="math inline">\(\binom{1/2}{0} = 1\)</span> (product of zero terms in the numerator equals <span class="math inline">\(1\)</span> and the denominator is <span class="math inline">\(0! = 1\)</span>).</p>
</div>
<div id="exm-central-binomial-ogf" class="theorem example">
<p><span class="theorem-title"><strong>Example 13.1</strong></span> Take the second formula, and use it with <a href="#thm-newton-binom" class="quarto-xref">Theorem&nbsp;<span>13.4</span></a>. We will put <span class="math inline">\((-4x)^k\)</span> instead of <span class="math inline">\(x^k\)</span> to cancel the <span class="math inline">\((-1/4)^k\)</span>. That is, <span class="math display">\[\begin{align*}
\frac{1}{\sqrt{1 - 4x}} = (1 - 4x)^{-1/2} &amp;= \sum_{k = 0}^\infty \binom{-1/2}{k} (-4x)^k \\
&amp;= \sum_{k = 0}^\infty \frac{(-1)^k}{4^k} \binom{2k}{k} (-4x)^k \\
&amp;= \sum_{k = 0}^\infty \binom{2k}{k} x^k \\
\end{align*}\]</span></p>
</div>
<p>This is a neat little result in and of itself but there is deeper implications here. Consider the number of binary strings of length <span class="math inline">\(2k\)</span> with an equal number of <span class="math inline">\(0\)</span>s and <span class="math inline">\(1\)</span>s. That means there are <span class="math inline">\(k\)</span> of each, and that gives us the formula <span class="math inline">\(\binom{2k}{k}\)</span>. These are called the <strong>central binomial coefficients</strong> because they appear right down the center of Pascal’s triangle.</p>
<p>For those of you who have taken computer science or mathematical linguistics, there is a concept known as a “regular language”—languages which can be parsed by a regular expresion<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. For these regular languages, we will see later on, that they always yeild a <em>rational</em> generating function. Here we have a non-rational generating function and indeed this language of strings with equal numbers of <span class="math inline">\(0\)</span>s and <span class="math inline">\(1\)</span>s is not a regular language.</p>
<p>Going beyond regular languages, the <a href="https://en.wikipedia.org/wiki/Chomsky%E2%80%93Sch%C3%BCtzenberger_enumeration_theorem">Chomsky–Schützenberger Theorem</a> says that if you have an unambiguous context-free grammar, then the generating function for that language is <em>algebraic</em>. That is what we are looking at with <span class="math inline">\(\frac{1}{\sqrt{1 - 4x}}\)</span>. This is an algebraic function because it is a square root of a rational function. Indeed, the language of strings with equal numbers of <span class="math inline">\(0\)</span>s and <span class="math inline">\(1\)</span>s is a context-free language.</p>
</section>
<section id="catalan-numbers" class="level3" data-number="13.5.3">
<h3 data-number="13.5.3" class="anchored" data-anchor-id="catalan-numbers"><span class="header-section-number">13.5.3</span> Catalan Numbers</h3>
<p>If you remember the formula for the Catalan numbers even vaguely, you’ll recognize the <span class="math inline">\(\binom{2k}{k}\)</span>. If you squint real hard, the first formula of <a href="#thm-half-binom" class="quarto-xref">Theorem&nbsp;<span>13.6</span></a> looks vaguely similar once you deal with the <span class="math inline">\((-1)^k\)</span> and the <span class="math inline">\(4^k\)</span> as we did in <a href="#exm-central-binomial-ogf" class="quarto-xref">Example&nbsp;<span>13.1</span></a>. Let’s dig into that.</p>
<p>First, recall the decomposition we had for Dyck paths.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../i/catalan-decomposition.svg" class="img-fluid figure-img"></p>
<figcaption>Dyck path decomposition based on the first place the path hits the line <span class="math inline">\(y = x\)</span></figcaption>
</figure>
</div>
<p>In terms of “the language of Dyck paths,” what this says is that a Dyck path of length <span class="math inline">\(n\)</span> is equal to</p>
<ol type="1">
<li>a shift one step up from the diagonal</li>
<li>a Dyck path of length <span class="math inline">\(k - 1\)</span></li>
<li>a Dyck path of length <span class="math inline">\(n - k\)</span></li>
</ol>
<p>Here’s the beauty of generating functions: as long as we keep track of the shifts, we don’t need to keep track of the lengths of the subwords or subpaths. So we can describe the language of Dyck paths in simpler terms: it is a shift, together with two smaller Dyck paths. Therefore, if we represent our shift by the monomial <span class="math inline">\(x\)</span>, and our Catalan generating function by <span class="math inline">\(C(x)\)</span>, what we have here is <span class="math inline">\(xC(x)^2\)</span>.</p>
<p>We almost have it, we just need to be careful of the edge case. If <span class="math inline">\(n = 0\)</span>, the path from <span class="math inline">\((0,0)\)</span> to <span class="math inline">\((0,0)\)</span> is a valid Dyck path which involves no shift. So a Dyck path is either</p>
<ol type="a">
<li>this length <span class="math inline">\(0\)</span> Dyck path, which has OGF <span class="math inline">\(x^0 = 1\)</span></li>
<li>a shift, together with two Dyck paths, with OGF <span class="math inline">\(xC(x)^2\)</span>.</li>
</ol>
<p>Therefore, <span class="math inline">\(C(x)\)</span> satisfies the equation <span class="math display">\[
C(x) = 1 + xC(x)^2.
\]</span></p>
<p>If you solve this quadratic equation using the quadratic formula, we find that <span id="eq-initial-catalan-sol"><span class="math display">\[
C(x) = \frac{1 \pm \sqrt{1 - 4x}}{2x}.
\tag{13.2}\]</span></span></p>
<p>In order to get numbers out of this, we use <a href="#thm-newton-binom" class="quarto-xref">Theorem&nbsp;<span>13.4</span></a> to expand the square root (separating the <span class="math inline">\(k = 0\)</span> term so we can apply the formula from <a href="#thm-half-binom" class="quarto-xref">Theorem&nbsp;<span>13.6</span></a>): <span class="math display">\[\begin{align*}
\sqrt{1 - 4x} &amp;= 1 + \sum_{k = 1}^\infty \binom{1/2}{k}(-4x)^k \\
&amp;= 1 + \sum_{k = 1}^\infty (-1)^{k-1} \frac{1}{2^{2k - 1}k} \binom{2k-2}{k - 1} (-4x)^k \\
&amp;= 1 + \sum_{k = 1}^\infty \frac{-2}{k} \binom{2k-2}{k - 1} x^k.
\end{align*}\]</span></p>
<p>The presence of the <span class="math inline">\(-\)</span> sign indicates that we want to use the negative square root in <a href="#eq-initial-catalan-sol" class="quarto-xref">Equation&nbsp;<span>13.2</span></a>. Doing this, we obtain</p>
<p><span class="math display">\[\begin{align*}
- \sqrt{1 - 4x} &amp;= - 1 + \sum_{k = 1}^\infty \frac{2}{k} \binom{2k-2}{k - 1} x^k \\
1 - \sqrt{1 - 4x} &amp;= \sum_{k = 1}^\infty \frac{2}{k} \binom{2k-2}{k - 1} x^k \\
\frac{1 - \sqrt{1 - 4x}}{2x} &amp;= \sum_{k = 1}^\infty \frac{1}{k} \binom{2k-2}{k - 1} x^{k - 1} \\
&amp;= \sum_{k = 0}^\infty \frac{1}{k + 1} \binom{2k}{k} x^k
\end{align*}\]</span> (adding <span class="math inline">\(1\)</span> to each <span class="math inline">\(k\)</span> to get from <span class="math inline">\(k - 1\)</span> to <span class="math inline">\(k\)</span>).</p>
<p>We’ve now found another way to get our Catalan number formula.</p>
<div id="thm-catalan-ogf" class="theorem">
<p><span class="theorem-title"><strong>Theorem 13.7 (Catalan OGF)</strong></span> The generating function for the Catalan numbers is <span class="math display">\[
C(x) = \frac{1 - \sqrt{1 - 4x}}{2x} = \sum_{k = 0}^\infty \frac{1}{k + 1} \binom{2k}{k} x^k.
\]</span></p>
</div>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We’ll define many of these terms in a later section for those of you who haven’t seen them before.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/trevorgunn\.github\.io\/combinatorics-notes\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../generating-functions/stars-and-bars-revisited.html" class="pagination-link" aria-label="Stars and Bars Revisited">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Stars and Bars Revisited</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../generating-functions/generating-function-exercises.html" class="pagination-link" aria-label="Exercises">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Exercises</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/trevorgunn/combinatorics-notes/edit/main/generating-functions/coefficient-extraction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/trevorgunn/combinatorics-notes/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li><li><a href="https://github.com/trevorgunn/combinatorics-notes/blob/main/generating-functions/coefficient-extraction.qmd" class="toc-action"><i class="bi empty"></i>View source</a></li></ul></div></div></div></footer></body></html>